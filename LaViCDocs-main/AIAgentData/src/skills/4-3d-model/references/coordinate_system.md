# 坐标系变换规则 (Coordinate System Transform)

## LaViC 目标坐标系

LaViC 平台使用 **Y-Up** 坐标系：
- **X 轴**：右
- **Y 轴**：上
- **Z 轴**：朝向观察者（屏幕外）

模型机头/车头应朝向 **Y+ 方向**。

## 常见源坐标系

| 来源 | 坐标系 | 需要的变换 |
|------|--------|-----------|
| Blender 默认 | Z-Up | X 轴 -90° + Y 轴 180° |
| Rodin AI 生成 | Z-Up | X 轴 -90° + Y 轴 180° |
| 3ds Max | Z-Up | X 轴 -90° + Y 轴 180° |
| Unity | Y-Up, 左手 | 可能需要 Z 轴翻转 |
| Unreal | Z-Up, 左手 | X 轴 -90° + Y 轴 180° |

## 变换矩阵

### 步骤1：绕 X 轴旋转 -90°（Z-Up → Y-Up）

```
┌ 1   0    0   0 ┐
│ 0   0    1   0 │
│ 0  -1    0   0 │
└ 0   0    0   1 ┘
```

效果：原来的 Z 轴（上）变为 Y 轴（上），原来的 Y 轴变为 -Z 轴。

### 步骤2：绕 Y 轴旋转 180°（朝向修正）

```
┌-1   0    0   0 ┐
│ 0   1    0   0 │
│ 0   0   -1   0 │
└ 0   0    0   1 ┘
```

效果：机头从 -Y 翻转到 Y+。

### 合成矩阵（步骤1 × 步骤2）

```python
import numpy as np

# 步骤1
rot_x = np.array([
    [1,  0,  0, 0],
    [0,  0,  1, 0],
    [0, -1,  0, 0],
    [0,  0,  0, 1]
])

# 步骤2
rot_y = np.array([
    [-1, 0,  0, 0],
    [ 0, 1,  0, 0],
    [ 0, 0, -1, 0],
    [ 0, 0,  0, 1]
])

# 合成：先 X 再 Y
combined = rot_y @ rot_x
```

## 验证方法

修正后检查：
1. 模型正立（不倒、不侧翻）
2. 机头/车头朝 Y+ 方向（绿色轴）
3. 模型中心在原点附近
4. 最低点 Z ≈ 0
